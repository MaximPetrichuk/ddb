function getColumns(e){var t=[];return $.each(e[0],function(e,n){var a={};a.headertext=e,a.datatype="string",a.datafield=e,t.push(a)}),t}(function(e){var t={containerid:null,datatype:"table",dataset:null,columns:null,returnUri:!1,worksheetName:"My Worksheet",encoding:"utf-8"},n=t;e.fn.excelexportjs=function(a){function r(){var e=n.datatype.toLowerCase();switch(i(e),e){case"table":m=c(o());break;case"json":m=c(s());break;case"xml":m=c(s());break;case"jqgrid":m=c(s())}return n.returnUri?m:void(l()||window.open(m))}function i(t){switch(t){case"table":break;case"json":x=n.dataset;break;case"xml":e(n.dataset).find("row").each(function(t,n){var a={};null!=this.attributes&&this.attributes.length>0&&(e(this.attributes).each(function(){a[this.name]=this.value}),x.push(a))});break;case"jqgrid":e(n.dataset).find("rows > row").each(function(t,n){var a={};null!=this.children&&this.children.length>0&&(e(this.children).each(function(){a[this.tagName]=e(this).text()}),x.push(a))})}}function o(){var t=e("<div>").append(e("#"+n.containerid).clone()).html();return t}function s(){var t="<table id='tabledata'>";return t+="<thead><tr>",e(n.columns).each(function(e,n){1!=this.ishidden&&(t+="<th",null!=this.width&&(t+=" style='width: "+this.width+"'"),t+=">",t+=this.headertext,t+="</th>")}),t+="</tr></thead>",t+="<tbody>",e(x).each(function(a,r){t+="<tr>",e(n.columns).each(function(e,n){r.hasOwnProperty(this.datafield)&&1!=this.ishidden&&(t+="<td",null!=this.width&&(t+=" style='width: "+this.width+"'"),t+=">",t+=r[this.datafield],t+="</td>")}),t+="</tr>"}),t+="</tbody>",t+="</table>"}function c(e){if(!l()){var a="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";a+="<head>",a+='<meta http-equiv="Content-type" content="text/html;charset='+t.encoding+'" />',a+="<!--[if gte mso 9]>",a+="<xml>",a+="<x:ExcelWorkbook>",a+="<x:ExcelWorksheets>",a+="<x:ExcelWorksheet>",a+="<x:Name>",a+="{worksheet}",a+="</x:Name>",a+="<x:WorksheetOptions>",a+="<x:DisplayGridlines/>",a+="</x:WorksheetOptions>",a+="</x:ExcelWorksheet>",a+="</x:ExcelWorksheets>",a+="</x:ExcelWorkbook>",a+="</xml>",a+="<![endif]-->",a+="</head>",a+="<body>",a+=e.replace(/"/g,"'"),a+="</body>",a+="</html>";var r="data:application/vnd.ms-excel;base64,",i={worksheet:n.worksheetName,table:e};return r+d(h(a,i))}u(e)}function d(e){return window.btoa(unescape(encodeURIComponent(e)))}function h(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})}function l(){var e=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g);return e>0}function u(e){var t=document.createElement("div");t.innerHTML=e;var a,r="<table border='2px'><tr bgcolor='#87AFC6'>",i=0;for(a="table"==n.datatype.toLowerCase()?document.getElementById(n.containerid):t.children[0],i=0;i<a.rows.length;i++)r=r+a.rows[i].innerHTML+"</tr>";r+="</table>",r=r.replace(/<A[^>]*>|<\/A>/g,""),r=r.replace(/<img[^>]*>/gi,""),r=r.replace(/<input[^>]*>|<\/input>/gi,"");var o=window.navigator.userAgent,s=o.indexOf("MSIE ");return s>0||navigator.userAgent.match(/Trident.*rv\:11\./)?(txtArea1.document.open("txt/html","replace"),txtArea1.document.write(r),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,"download")):sa=window.open("data:application/vnd.ms-excel,"+encodeURIComponent(r)),sa}n=e.extend({},t,a);var m,x=[];return r()}})(jQuery);